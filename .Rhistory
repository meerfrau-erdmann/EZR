hist(vol)
par(mfrow=c(1,2))
hist(savr)
hist(pevr)
par(mfrow=c(2,3))
hist(sand)
hist(rock)
hist(peb)
hist(rug)
hist(rugp)
hist(height)
par(mfrow=c(1,2))
hist(Abundance)
hist(Richness)
# first row, then column
par(mfrow=c(2,3))
hist(dep)
hist(wid)
hist(leng)
hist(per)
hist(vol)
hist(height)
par(mfrow=c(1,2))
hist(savr)
hist(pevr)
par(mfrow=c(2,3))
hist(sand)
hist(rock)
hist(peb)
hist(rug)
hist(rugp)
par(mfrow=c(1,2))
hist(Abundance)
hist(Richness)
ezr.pool<-select(ezr, dep, wid, leng, vol, height, savr, pevr)
scatterplotMatrix(x=ezr.pool, diagonal='boxplot')
scatterplotMatrix(x=ezr.sub, diagonal='boxplot')
scatterplotMatrix(x=ezr.abri, diagonal='boxplot')
# first row, then column
par(mfrow=c(2,3))
hist(dep)
hist(wid)
hist(leng)
hist(per)
hist(vol)
hist(height)
par(mfrow=c(1,2))
hist(savr)
hist(pevr)
par(mfrow=c(2,3))
hist(sand)
hist(rock)
hist(peb)
hist(alg)
hist(rug)
hist(rugp)
par(mfrow=c(1,2))
hist(Abundance)
hist(Richness)
knitr::opts_chunk$set(echo = TRUE)
ezr.pool<-select(ezr, log(dep), log(wid), log(leng), log(vol), log(height), log(savr), log(pevr))
knitr::opts_chunk$set(echo = TRUE)
library(emmeans)
library(ggplot2)
library(ggfortify)
library(vegan)
library(car)
library(tidyverse)
ezr<-read.csv('C:/Users/admin/Desktop/Peces el zonte/EZR1.csv', strip.white=T)
head(ezr)
summary(ezr)
str(ezr)
ezr<- select(ezr, -tl,-OS, -RS, -BA, -species)
head(ezr)
mutate(ezr, pool=as.factor(pool))
ggplot(ezr, aes(x=pool, y=fish)) +
geom_point(aes(x=pool, y=fish)) +
ggtitle("Species presence in the pools")
ggplot(ezr, aes(x=savr, y=fish)) +
geom_point(aes(x=savr, y=fish)) +
ggtitle("Species presence related to surface area and volume")
ggplot(ezr, aes(x=pevr, y=fish)) +
geom_point(aes(x=pevr, y=fish)) +
ggtitle("Species presence related to perimetry and volume")
boxplot(ezr)
# first row, then column
par(mfrow=c(2,3))
hist(dep)
ezr.pool<-select(ezr, log(dep), log(wid), log(leng), log(vol), log(height), log(savr), log(pevr))
knitr::opts_chunk$set(echo = TRUE)
library(emmeans)
library(ggplot2)
library(ggfortify)
library(vegan)
library(car)
library(tidyverse)
ezr<-read.csv('C:/Users/admin/Desktop/Peces el zonte/EZR1.csv', strip.white=T)
head(ezr)
summary(ezr)
str(ezr)
ezr<- select(ezr, -tl,-OS, -RS, -BA, -species)
head(ezr)
mutate(ezr, pool=as.factor(pool))
ggplot(ezr, aes(x=pool, y=fish)) +
geom_point(aes(x=pool, y=fish)) +
ggtitle("Species presence in the pools")
ggplot(ezr, aes(x=savr, y=fish)) +
geom_point(aes(x=savr, y=fish)) +
ggtitle("Species presence related to surface area and volume")
ggplot(ezr, aes(x=pevr, y=fish)) +
geom_point(aes(x=pevr, y=fish)) +
ggtitle("Species presence related to perimetry and volume")
boxplot(ezr)
# first row, then column
par(mfrow=c(2,3))
hist(dep)
# first row, then column
par(mfrow=c(2,3))
hist(dep)
# first row, then column
par(mfrow=c(2,3))
hist(dep)
knitr::opts_chunk$set(echo = TRUE)
library(emmeans)
library(ggplot2)
library(ggfortify)
library(vegan)
library(car)
library(tidyverse)
ezr<-read.csv('C:/Users/admin/Desktop/Peces el zonte/EZR1.csv', strip.white=T)
head(ezr)
summary(ezr)
str(ezr)
ezr<- select(ezr, -tl,-OS, -RS, -BA, -species)
head(ezr)
mutate(ezr, pool=as.factor(pool))
ggplot(ezr, aes(x=pool, y=fish)) +
geom_point(aes(x=pool, y=fish)) +
ggtitle("Species presence in the pools")
ggplot(ezr, aes(x=savr, y=fish)) +
geom_point(aes(x=savr, y=fish)) +
ggtitle("Species presence related to surface area and volume")
ggplot(ezr, aes(x=pevr, y=fish)) +
geom_point(aes(x=pevr, y=fish)) +
ggtitle("Species presence related to perimetry and volume")
boxplot(ezr)
# first row, then column
par(mfrow=c(2,3))
attach(ezr)
hist(dep)
hist(wid)
hist(leng)
hist(per)
hist(vol)
hist(height)
par(mfrow=c(1,2))
hist(savr)
hist(pevr)
par(mfrow=c(2,3))
hist(sand)
hist(rock)
hist(peb)
hist(alg)
hist(rug)
hist(rugp)
par(mfrow=c(1,2))
hist(Abundance)
hist(Richness)
# first row, then column
par(mfrow=c(2,3))
attach(ezr)
hist(log(dep))
hist(log(wid))
hist(log(leng))
hist(log(per))
hist(log(vol))
hist(height)
par(mfrow=c(1,2))
hist(log(savr))
hist(log(pevr))
par(mfrow=c(2,3))
hist(sqrt(sand))
hist(sqrt(rock))
hist(log(peb))
hist(log(alg))
hist(log(rug))
hist(log(rugp))
par(mfrow=c(1,2))
hist(log(Abundance))
hist(log(Richness))
#tezr= transformed ezr
tezr<-ezr %>% mutate(dep=log(dep), wid=log(wid), Abundance=log(Abundance), Richness=log(Richness))
ezr.pool<-select(ezr, dep, wid, leng, vol, height, savr, pevr)
ezr.sub<-select(ezr, sand, rock, peb, alg, rug, rugp)
ezr.abri<-select(ezr, savr, pevr, Abundance, Richness)
scatterplotMatrix(x=ezr.pool, diagonal='boxplot')
scatterplotMatrix(x=ezr.sub, diagonal='boxplot')
scatterplotMatrix(x=ezr.abri, diagonal='boxplot')
ezr.glm<-glm(fish~pool, family=binomial(link='logit'), data=ezr)
ezr.glm1<-glm(fish~pool, family=binomial(link='cloglog'), data=ezr)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(fish~dep*wid*leng*per*vol*savr*pevr*samd*rock*peb*alg*rug*rugp*height, family=binomial(link='probit'), data=ezr)
ezr.glm<-glm(fish~pool, family=binomial(link='logit'), data=ezr)
ezr.glm1<-glm(fish~pool, family=binomial(link='cloglog'), data=ezr)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(fish~dep*wid*leng*per*vol*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='probit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm, ezr.glm1, ezr.glm2)
ezr.glm<-glm(fish~pool, family=binomial(link='logit'), data=ezr)
ezr.glm1<-glm(fish~pool, family=binomial(link='cloglog'), data=ezr)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(fish~dep*wid*leng*per*vol*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='probit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm, ezr.glm1, ezr.glm2, ezr.glm)
ezr.glm<-glm(fish~pool, family=binomial(link='logit'), data=ezr)
ezr.glm1<-glm(fish~pool, family=binomial(link='cloglog'), data=ezr)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(fish~dep*wid*leng*per*vol*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='probit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm, ezr.glm1, ezr.glm2, ezr.glm3)
ezr.glm<-glm(fish~pool, family=binomial(link='logit'), data=ezr)
ezr.glm1<-glm(fish~pool, family=binomial(link='cloglog'), data=ezr)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(fish~log(dep)*wid*leng*per*vol*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='probit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm, ezr.glm1, ezr.glm2, ezr.glm3)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(fish~log(dep)*log(wid)*log(leng)*log(per)*log(vol)*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='probit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm, ezr.glm1, ezr.glm2, ezr.glm3)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(fish~log(dep)*log(wid)*log(leng)*log(per)*log(vol)*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='logit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm, ezr.glm1, ezr.glm2, ezr.glm3)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(Abundance~log(dep)*log(wid)*log(leng)*log(per)*log(vol)*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='logit'), data=ezr)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(pool~log(dep)*log(wid)*log(leng)*log(per)*log(vol)*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='logit'), data=ezr)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(log(1+Abundance)~log(dep)*log(wid)*log(leng)*log(per)*log(vol)*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='logit'), data=ezr)
ezr.glm2<-glm(fish~pool, family=binomial(link='probit'), data=ezr)
ezr.glm3<-glm(fish~log(dep)*log(wid)*log(leng)*log(per)*log(vol)*savr*pevr*sand*rock*peb*alg*rug*rugp*height, family=binomial(link='logit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm2, ezr.glm3)
# decostand is used to do standardizations
ezr.std<-decostand(ezr[,-1], "standardize")
# decostand is used to do standardizations
ezr.std<-decostand(ezr, "standardize")
knitr::opts_chunk$set(echo = TRUE)
# LD50 analog to the likelihood of fish being present or absent.
# brackets help to asign and spit out the result at the same time
(ld50<- -ezr.glm3$coef[1]/ezr.glm3$coef[2])
knitr::opts_chunk$set(echo = TRUE)
library(emmeans)
library(ggplot2)
library(ggfortify)
library(vegan)
library(car)
library(tidyverse)
ezr<-read.csv('C:/Users/admin/Desktop/Peces el zonte/EZR1.csv', strip.white=T)
head(ezr)
summary(ezr)
str(ezr)
ezr<- select(ezr, -tl,-OS, -RS, -BA, -species)
head(ezr)
mutate(ezr, pool=as.factor(pool))
ggplot(ezr, aes(x=pool, y=fish)) +
geom_point(aes(x=pool, y=fish)) +
ggtitle("Species presence in the pools")
ggplot(ezr, aes(x=savr, y=fish)) +
geom_point(aes(x=savr, y=fish)) +
ggtitle("Species presence related to surface area and volume")
ggplot(ezr, aes(x=pevr, y=fish)) +
geom_point(aes(x=pevr, y=fish)) +
ggtitle("Species presence related to perimetry and volume")
boxplot(ezr)
# first row, then column
par(mfrow=c(2,3))
attach(ezr)
hist(dep)
hist(wid)
hist(leng)
hist(per)
hist(vol)
hist(height)
par(mfrow=c(1,2))
hist(savr)
hist(pevr)
par(mfrow=c(2,3))
hist(sand)
hist(rock)
hist(peb)
hist(alg)
hist(rug)
hist(rugp)
par(mfrow=c(1,2))
hist(Abundance)
hist(Richness)
# first row, then column
par(mfrow=c(2,3))
attach(ezr)
hist(log(dep))
hist(log(wid))
hist(log(leng))
hist(log(per))
hist(log(vol))
hist(height)
par(mfrow=c(1,2))
hist(log(savr))
hist(log(pevr))
par(mfrow=c(2,3))
hist(sqrt(sand))
hist(sqrt(rock))
hist(log(peb))
hist(log(alg))
hist(log(rug))
hist(log(rugp))
par(mfrow=c(1,2))
hist(log(1+Abundance))
hist(log(1+Richness))
#tezr= transformed ezr
tezr<-ezr %>% mutate(dep=log(dep), wid=log(wid), Abundance=log(1+Abundance), Richness=log(1+Richness))
ezr.pool<-select(ezr, dep, wid, leng, vol, height, savr, pevr)
ezr.sub<-select(ezr, sand, rock, peb, alg, rug, rugp)
ezr.abri<-select(ezr, savr, pevr, Abundance, Richness)
scatterplotMatrix(x=ezr.pool, diagonal='boxplot')
scatterplotMatrix(x=ezr.sub, diagonal='boxplot')
scatterplotMatrix(x=ezr.abri, diagonal='boxplot')
ezr.glm3<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
ezr.glm4<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, family=binomial(link='probit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm3, ezr.glm4)
autoplot(ezr.glm3, which=1:6, ncol=2, label.size=3)
ezr.resid<-sum(resid(ezr.glm3, type="pearson")^2)
1-pchisq(ezr.resid, ezr.glm3$df.resid)
1-pchisq(ezr.glm3$deviance, ezr.glm3$df.resid)
summary(ezr.glm3)
vif(ezr.glm3)
# since the values are less than 3 (or 5), we
# values were removed or taken because the vif was less or greater than 3 or 5
# if vif is to big, (1) you take them out of the model (2) you combine the variables (predictors) by multivariate techniques since they correlate (3) you run the correlated predictors in separated models
# LD50 analog to the likelihood of fish being present or absent.
# brackets help to asign and spit out the result at the same time
(ld50<- -ezr.glm3$coef[1]/ezr.glm3$coef[2])
ezr.glm3<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
ezr.glm4<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, family=binomial(link='probit'), data=ezr)
pooltraits.glm<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+height, family=binomial(link='logit'), data=ezr)
substrate.glm<-glm(fish~log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm3, ezr.glm4)
ezr.glm3<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
ezr.glm4<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, family=binomial(link='probit'), data=ezr)
pool.glm<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+height, family=binomial(link='logit'), data=ezr)
sub.glm<-glm(fish~log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm3, ezr.glm4, pool.glm, sub.glm)
ezr.glm3<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
ezr.glm4<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, family=binomial(link='probit'), data=ezr)
pool.glm<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr), family=binomial(link='logit'), data=ezr)
sub.glm<-glm(fish~log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm3, ezr.glm4, pool.glm, sub.glm)
autoplot(sub.glm, which=1:6, ncol=2, label.size=3)
ezr.resid<-sum(resid(sub.glm, type="pearson")^2)
1-pchisq(ezr.resid, sub.glm$df.resid)
1-pchisq(sub.glm$deviance, sub.glm$df.resid)
ezr.glm3<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
ezr.glm4<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, family=binomial(link='probit'), data=ezr)
pool.glm<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr), family=binomial(link='logit'), data=ezr)
sub.glm<-glm(fish~log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm3, ezr.glm4, pool.glm, sub.glm)
autoplot(ezr.glm3, which=1:6, ncol=2, label.size=3)
knitr::opts_chunk$set(echo = TRUE)
library(emmeans)
library(ggplot2)
library(ggfortify)
library(vegan)
library(car)
library(tidyverse)
ezr<-read.csv('C:/Users/admin/Desktop/Peces el zonte/EZR1.csv', strip.white=T)
head(ezr)
summary(ezr)
str(ezr)
ezr<- select(ezr, -tl,-OS, -RS, -BA, -species)
head(ezr)
mutate(ezr, pool=as.factor(pool))
ggplot(ezr, aes(x=pool, y=fish)) +
geom_point(aes(x=pool, y=fish)) +
ggtitle("Species presence in the pools")
ggplot(ezr, aes(x=savr, y=fish)) +
geom_point(aes(x=savr, y=fish)) +
ggtitle("Species presence related to surface area and volume")
ggplot(ezr, aes(x=pevr, y=fish)) +
geom_point(aes(x=pevr, y=fish)) +
ggtitle("Species presence related to perimetry and volume")
boxplot(ezr)
# first row, then column
par(mfrow=c(2,3))
attach(ezr)
hist(dep)
hist(wid)
hist(leng)
hist(per)
hist(vol)
hist(height)
par(mfrow=c(1,2))
hist(savr)
hist(pevr)
par(mfrow=c(2,3))
hist(sand)
hist(rock)
hist(peb)
hist(alg)
hist(rug)
hist(rugp)
par(mfrow=c(1,2))
hist(Abundance)
hist(Richness)
# first row, then column
par(mfrow=c(2,3))
attach(ezr)
hist(log(dep))
hist(log(wid))
hist(log(leng))
hist(log(per))
hist(log(vol))
hist(height)
par(mfrow=c(1,2))
hist(log(savr))
hist(log(pevr))
par(mfrow=c(2,3))
hist(sqrt(sand))
hist(sqrt(rock))
hist(log(peb))
hist(log(alg))
hist(log(rug))
hist(log(rugp))
par(mfrow=c(1,2))
hist(log(1+Abundance))
hist(log(1+Richness))
#tezr= transformed ezr
tezr<-ezr %>% mutate(dep=log(dep), wid=log(wid), Abundance=log(1+Abundance), Richness=log(1+Richness))
ezr.pool<-select(ezr, dep, wid, leng, vol, height, savr, pevr)
ezr.sub<-select(ezr, sand, rock, peb, alg, rug, rugp)
ezr.abri<-select(ezr, savr, pevr, Abundance, Richness)
scatterplotMatrix(x=ezr.pool, diagonal='boxplot')
scatterplotMatrix(x=ezr.sub, diagonal='boxplot')
scatterplotMatrix(x=ezr.abri, diagonal='boxplot')
ezr.glm3<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
ezr.glm4<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, family=binomial(link='probit'), data=ezr)
pool.glm<-glm(fish~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr), family=binomial(link='logit'), data=ezr)
sub.glm<-glm(fish~log(1+sand)+log(rock)+peb+alg+rug+rugp+height, family=binomial(link='logit'), data=ezr)
# AIC is used to compare the models; lowest AIC is the best or within two units within each other
AIC(ezr.glm3, ezr.glm4, pool.glm, sub.glm)
autoplot(ezr.glm3, which=1:6, ncol=2, label.size=3)
ezr.resid<-sum(resid(ezr.glm3, type="pearson")^2)
1-pchisq(ezr.resid, ezr.glm3$df.resid)
1-pchisq(ezr.glm3$deviance, ezr.glm3$df.resid)
summary(ezr.glm3)
vif(ezr.glm3)
# since the values are less than 3 (or 5), we
# values were removed or taken because the vif was less or greater than 3 or 5
# if vif is to big, (1) you take them out of the model (2) you combine the variables (predictors) by multivariate techniques since they correlate (3) you run the correlated predictors in separated models
# LD50 analog to the likelihood of fish being present or absent.
# brackets help to asign and spit out the result at the same time
(ld50<- -ezr.glm3$coef[1]/ezr.glm3$coef[2])
library(MASS)
# nb = negative binomial
ezr.nb=glm.nb(fish~savr*pevr, data=ezr)
library(MASS)
# nb = negative binomial
ezr.nb=glm.nb(Abundance~savr*pevr, data=ezr)
autoplot(ezr.nb, which=1:6)
ezr.resid=sum(resid(ezr.nb, type='pearson')^2)
1-pchisq(ezr.resid, df=ezrnb$df.residual)
library(MASS)
# nb = negative binomial
ezr.nb=glm.nb(Abundance~savr*pevr, data=ezr)
autoplot(ezr.nb, which=1:6)
ezr.resid=sum(resid(ezr.nb, type='pearson')^2)
1-pchisq(ezr.resid, df=ezr.nb$df.residual)
library(MASS)
# nb = negative binomial
ezr.nb=glm.nb(Abundance~log(dep)+log(wid)+log(leng)+log(per)+log(vol)+log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, data=ezr)
autoplot(ezr.nb, which=1:6)
ezr.resid=sum(resid(ezr.nb, type='pearson')^2)
1-pchisq(ezr.resid, df=ezr.nb$df.residual)
ezr.resid/ezr.nb$df.residual
# no evidence of lack of fit, because the value is close to 1
summary(ezr.nb)
plot(allEffects(quinn.nb), multiline=TRUE, ci.style='bar')
library(nlme)
(allEffects(quinn.nb), multiline=TRUE, ci.style='bar')
library(nlme)
allEffects(ezr.nb), multiline=TRUE, ci.style='bar'
library(nlme)
plot(allEffects(ezr.nb), multiline=TRUE, ci.style='bar')
library(nlme)
plot(allEffects(ezr.nb), multiline=TRUE, ci.style='bar')
library(effects)
plot(allEffects(ezr.nb), multiline=TRUE, ci.style='bar')
ezr.nb=glm.nb(Abundance~log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, data=ezr)
autoplot(ezr.nb, which=1:6)
ezr2.nb=glm.nb(Abundance~log(savr)+log(pevr)+sand+rock+peb+alg+rug+rugp+height, data=ezr)
autoplot(ezr2.nb, which=1:6)
ezr.resid=sum(resid(ezr2.nb, type='pearson')^2)
1-pchisq(ezr.resid, df=ezr2.nb$df.residual)
ezr.resid/ezr2.nb$df.residual
summary(ezr2.nb)
library(effects)
plot(allEffects(ezr2.nb), multiline=TRUE, ci.style='bar')
